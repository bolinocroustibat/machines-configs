# Protect against PHP URL-fopen() exploitation attempts
# This jail catches attempts to use PHP's URL-fopen() functionality through GET/POST variables
# which could be used to include malicious remote files or perform SSRF attacks
[php-url-fopen]
enabled = true
port = http,https
logpath = %(nginx_access_log)s

# Protect against PHP-FPM specific errors and attacks
# This jail monitors PHP-FPM error logs for:
# - Failed PHP-FPM worker processes
# - PHP-FPM configuration errors
# - PHP-FPM security-related issues
# - Attempts to exploit PHP-FPM vulnerabilities
[php-fpm]
enabled = true
port = http,https
logpath = /var/log/php8.4-fpm.log

# Protect against PHP shell upload attempts
# This jail catches attempts to upload PHP shell scripts through:
# - File upload forms
# - POST requests with PHP code
# - Common shell upload patterns
# - Known PHP shell signatures
[php-shell]
enabled = true
port = http,https
logpath = %(nginx_access_log)s
