# System-level bat installation, then per-user alias configuration.

- name: Install bat via Homebrew (MacOS)
  when: ansible_facts["os_family"] == 'Darwin'
  community.general.homebrew:
    name: bat
    state: present

- name: Install bat via apt (Debian)
  when: ansible_facts["os_family"] == 'Debian'
  become: true
  apt:
    name: bat
    state: present
    update_cache: true

# Per-user configuration: add cat alias to .zshrc
- name: Configure bat alias for users
  include_tasks: configure_user.yaml
  loop: "{{ shell_users_list }}"
  loop_control:
    loop_var: user_config
